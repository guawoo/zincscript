<?xml version="1.0" encoding="UTF-8"?>

<!-- script标签用于定义与此xml相关联的zincscript脚本 -->
<!-- 脚本可以放在2个位置：-->
<!-- 1 sandbox中：zincscript可以保存在程序内部，(对于symbian系统，可以定义在程序外部文件系统中)，
    使用属性"path"定义脚本文件的位置，属性"name"定义脚本的名字。使用方法如下： 
    注意：当没有"path"属性时，先从RMS中搜索脚本，再在资源中搜索，因为资源中的脚本可能以及过期了，
    更新的脚本在RMS中。-->
<script path="path of the zinc script" name="name of the zincscript"/>
<!-- 2 xml代码中：脚本也可以随着xml文件一起下发，只需要把zincscript代码写在script标签之间就OK
    注意：随xml一起下发的zincscript代码不会被存储，一旦离开了此功能单元，这段脚本代码随即失效-->
<script>
    # 登陆处理
    def login()
        string aid=_zsdGetName("name")
        string vid=_zsdGetValue("name")
        string apsw=_zsdGetName("psw")
        string vpsw=_zsdGetValue("psw")
    
        int savepsw=_zsdGetValue("remember")
        int autologin=_zsdGetValue("auto") 
        if savepsw==1
            _zsrInsert2RMS("account",0,vid,0);
            _zsrInsert2RMS("account",0,apsw,0)
        end
    
        _zsrSet2RMS("login",savepsw)
        _zsrSet2RMS("login",autologin)
    
        string url="http://3g.cn/login?"+aid+"="+vid+"&amp;"+apsw+"="+vpsw
        _zsnSend(url)
    end
    # 切换到取回密码界面
    def fetchpsw()
        _zssSwitch("fetchpsw.xml")
    end
    # 清除组件的值
    def clear(string id)
        _zsdSetValue(id,"")
    end
    # 自动登录
    def autologin()
        string name=_zsrGet4RMS("account",0);
        string psw=_zsrGet4RMS("account",0);
        int rem=_zsrGet4RMS("login",0)
        int autologin=_zsdGetValue("auto") 
        _zsdSetValue("name",name)
        _zsdSetValue("psw",psw)
        _zsdSetValue("remember",rem)
        _zsdSetValue("auto",autologin)
        if autoloin==1
            login()
        end
    end
</script>

<!-- unit是此xml的根，代表了下面定义的是某个Widget的功能组 -->
<unit> 
    <!-- div等同于html中的dev标签，可以把它理解成一个盒子，方便组织屏幕中的一组元素进行布局排版和DOM操作 -->
    <!--  onload是一个标准的事件接口，当整个xml解析完之后，执行其指定的函数-->
    <div id="login" onload="autologin">
        <textfield id="name" label="手机号(账号)" name="id" value="" type="number" lign="right" >
            <onfocus func="clear">
                <arg type="string" value="name"/>
            </onfocus>
        </textfield>
        <textfield id="psw" label="密码" value="" name="psw" type="password" lign="right"/>
        <checkbox id="remember" label="记住密码" value="false"/>
        <checkbox id="auto" label="自动登陆" value="false"/>
        <!--  onclick是一个标准的事件接口，当组件被点击时，执行其指定的函数-->
        <button id="go" label="登陆" onclick="login"/>
        <button id="fetchpsw" label="忘记密码" onclick="fetchpsw"/>
    </div>
</unit>
